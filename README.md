# ğŸš€ Viral Score Collector

ì†Œì…œ ë¯¸ë””ì–´ ë°”ì´ëŸ´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  DeFi í’€ì˜ ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ëŠ” ì‹¤ì‹œê°„ ì„œë²„ì…ë‹ˆë‹¤.

[![TypeScript](https://img.shields.io/badge/TypeScript-5.6-blue.svg)](https://www.typescriptlang.org/)
[![Bun](https://img.shields.io/badge/Bun-1.3-orange.svg)](https://bun.sh/)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15%2B-blue.svg)](https://www.postgresql.org/)

## ğŸ“‹ ëª©ì°¨

- [ê°œìš”](#ê°œìš”)
- [ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
- [ì„¤ì¹˜](#ì„¤ì¹˜)
- [í™˜ê²½ ì„¤ì •](#í™˜ê²½-ì„¤ì •)
- [ì‚¬ìš©ë²•](#ì‚¬ìš©ë²•)
- [API ë¬¸ì„œ](#api-ë¬¸ì„œ)
- [ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ](#ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ)
- [ìŠ¤ì¼€ì¤„ëŸ¬ ì‘ì—…](#ìŠ¤ì¼€ì¤„ëŸ¬-ì‘ì—…)
- [ë¬¸ì œ í•´ê²°](#ë¬¸ì œ-í•´ê²°)

---

## ğŸ¯ ê°œìš”

Viral Score CollectorëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•©ë‹ˆë‹¤:
- Memexì—ì„œ ì†Œì…œ ë¯¸ë””ì–´ ì°¸ì—¬ ë°ì´í„° ìˆ˜ì§‘
- ê°œë³„ í† í°ì˜ ë°”ì´ëŸ´ ì ìˆ˜ ê³„ì‚°
- DeFi ìœ ë™ì„± í’€ì„ ìœ„í•œ í˜ì–´ ì ìˆ˜ ìƒì„±
- ì˜¨ì²´ì¸ ê²€ì¦ì„ ìœ„í•œ ECDSA ì„œëª…
- íš¨ìœ¨ì ì¸ ë°°ì¹˜ ê²€ì¦ì„ ìœ„í•œ Merkle íŠ¸ë¦¬ êµ¬ì¶•
- REST API ë° WebSocket ìŠ¤íŠ¸ë¦¬ë° ì œê³µ

### ì¶”ì ë˜ëŠ” ì£¼ìš” ì§€í‘œ
- ê²Œì‹œë¬¼, ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ë¦¬í¬ìŠ¤íŠ¸, ëŒ“ê¸€
- ê³ ìœ  ì‚¬ìš©ì ìˆ˜
- ë³¸ë”© ì»¤ë¸Œ ì§„í–‰ë¥ 
- í† í° ê·¸ë˜ë“€ì—ì´ì…˜ ë¹„ìœ¨
- ì´ë¯¸ì§€ ê²Œì‹œë¬¼ ë¹„ìœ¨
- ê°€ê²© ë³€ë™ì„±

---

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ğŸ”¥ ì‹¤ì‹œê°„ ì ìˆ˜ ê³„ì‚°
- 10ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
- ì¦‰ê°ì ì¸ ì ‘ê·¼ì„ ìœ„í•œ ì¸ë©”ëª¨ë¦¬ ìºì‹±
- ì‹œê°„ ê°ì‡  ì•Œê³ ë¦¬ì¦˜ (24ì‹œê°„ ë°˜ê°ê¸°)
- ì¡°ì‘ ë°©ì§€ íƒì§€

### ğŸ“Š íˆìŠ¤í† ë¦¬ ì¶”ì 
- **í† í° ì ìˆ˜** ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
- **í˜ì–´ ì ìˆ˜** ì„œëª…ê³¼ í•¨ê»˜ ì €ì¥
- ë§¤ì‹œê°„ Merkle ì²´í¬í¬ì¸íŠ¸
- í˜ì´ì§€ë„¤ì´ì…˜ìœ¼ë¡œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ

### ğŸ” ì•”í˜¸í™” ë³´ì•ˆ
- ECDSA ì„œëª… ìƒì„±
- ë…¼ìŠ¤ ê¸°ë°˜ ì¬ìƒ ê³µê²© ë°©ì§€
- Merkle íŠ¸ë¦¬ ì¦ëª… ìƒì„±
- ì˜¨ì²´ì¸ ê²€ì¦ ê°€ëŠ¥í•œ ì ìˆ˜

### ğŸŒ ë‹¤ì¤‘ ì¸í„°í˜ì´ìŠ¤
- RESTful API ì—”ë“œí¬ì¸íŠ¸
- WebSocket ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë°
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ì§€ì›
- í—¬ìŠ¤ ëª¨ë‹ˆí„°ë§

### ğŸ“ˆ ê³ ê¸‰ ì ìˆ˜ ê³„ì‚°
- ë‹¤ìš”ì†Œ ì°¸ì—¬ë„ ê³„ì‚°
- ê°•í™”ëœ ë°°ìˆ˜ (ê·¸ë˜ë“€ì—ì´ì…˜ í† í°, ì´ë¯¸ì§€, ë³€ë™ì„±)
- ê³„ì¸µ ë¶„ë¥˜ (LEGENDARY ~ COLD)
- 0-10000 ë² ì´ì‹œìŠ¤ í¬ì¸íŠ¸ë¡œ ì •ê·œí™”

---

## ğŸ“¦ ì„¤ì¹˜

### ì‚¬ì „ ìš”êµ¬ì‚¬í•­

- **Bun** v1.0+ (ë˜ëŠ” Node.js v18+)
- **PostgreSQL** v15+
- **Git**

### ì„¤ì¹˜ ë‹¨ê³„

1. **ì €ì¥ì†Œ ë³µì œ**
   ```bash
   git clone https://github.com/meme-pulse/viral-score-collector.git
   cd viral-score-collector
   ```

2. **ì˜ì¡´ì„± ì„¤ì¹˜**
   ```bash
   bun install
   # ë˜ëŠ”
   npm install
   ```

3. **í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**
   ```bash
   cp .env.example .env
   # .env íŒŒì¼ì„ ìˆ˜ì •í•˜ì„¸ìš”
   ```

4. **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •**
   ```bash
   # ë°©ë²• 1: ì„¤ì • ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš© (PostgreSQL ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•¨)
   chmod +x scripts/setup-db.sh
   ./scripts/setup-db.sh

   # ë°©ë²• 2: ìˆ˜ë™ ì„¤ì •
   createdb viral_score_db
   bun run db:generate
   bun run db:migrate
   ```

5. **ì„œë²„ ì‹œì‘**
   ```bash
   # ê°œë°œ ëª¨ë“œ (í•« ë¦¬ë¡œë“œ)
   bun run dev

   # í”„ë¡œë•ì…˜ ëª¨ë“œ
   bun run start
   ```

---

## âš™ï¸ í™˜ê²½ ì„¤ì •

### í™˜ê²½ ë³€ìˆ˜

`.env` íŒŒì¼ì„ ìƒì„±í•˜ê³  ë‹¤ìŒ ë³€ìˆ˜ë¥¼ ì„¤ì •í•˜ì„¸ìš”:

```bash
# ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • (í•„ìˆ˜)
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/viral_score_db

# ì„œëª…ì ì„¤ì • (í•„ìˆ˜)
# ìƒì„±: openssl rand -hex 32
SIGNER_PRIVATE_KEY=0x0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ì„œë²„ ì„¤ì • (ì„ íƒ)
PORT=3001

# Memex API ì„¤ì • (ì„ íƒ)
MEMEX_API_BASE=https://app.memex.xyz/api/service/public

# ì„±ëŠ¥ íŠœë‹ (ì„ íƒ)
DB_CONCURRENT_SAVES=10          # ë™ì‹œ DB ì“°ê¸°
BACKFILL_PAGES=50               # ì´ˆê¸° íˆìŠ¤í† ë¦¬ í˜ì´ì§€
BACKFILL_RATE_LIMIT_DELAY=50    # ìš”ì²­ ê°„ ì§€ì—° (ms)
```

### Private Key ìƒì„±
```bash
# OpenSSL ì‚¬ìš©
openssl rand -hex 32

# Node.js ì‚¬ìš©
node -e "console.log('0x' + require('crypto').randomBytes(32).toString('hex'))"
```

---

## ğŸš€ ì‚¬ìš©ë²•

### ì„œë²„ ì‹œì‘

```bash
# ê°œë°œ ëª¨ë“œ (í•« ë¦¬ë¡œë“œ)
bun run dev

# í”„ë¡œë•ì…˜ ëª¨ë“œ
bun run start

# ì»¤ìŠ¤í…€ í¬íŠ¸ ì‚¬ìš©
PORT=8080 bun run start
```

### ì„œë²„ ì¶œë ¥

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    VIRAL SCORE SERVER                          â•‘
â•‘                        v1.0.0                                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘  Collecting social data from Memex                            â•‘
â•‘  Calculating viral scores for DeFi pools                      â•‘
â•‘  Providing signed scores for on-chain verification            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[Server] âœ… Database connected
[Scheduler] Performing initial backfill...
[Scheduler] Initial backfill complete:
  - Total posts: 1250
  - Unique tokens: 87
[Scheduler] All jobs started:
  - Score collection: every 10 seconds
  - Merkle checkpoint: every hour
  - Cache cleanup: every 5 minutes
[Server] ğŸš€ HTTP server running on http://localhost:3001
[Server] ğŸ”Œ WebSocket server running on ws://localhost:3001/ws
[Server] Ready to collect viral scores!
```

---

## ğŸ“– API ë¬¸ì„œ

ì „ì²´ API ë¬¸ì„œëŠ” [API.md](./API.md)ì—ì„œ í™•ì¸í•˜ì„¸ìš” (ì˜ë¬¸).

### ë¹ ë¥¸ ì˜ˆì œ

#### í† í° ì ìˆ˜ ì¡°íšŒ
```bash
curl http://localhost:3001/api/score/tokens/TRUMP
```

#### ë¦¬ë”ë³´ë“œ ì¡°íšŒ
```bash
curl http://localhost:3001/api/score/tokens/leaderboard?limit=10
```

#### í˜ì–´ ì ìˆ˜ ì„œëª…
```bash
curl -X POST http://localhost:3001/api/score/pair/TRUMP/SOL/sign
```

#### WebSocket ì—°ê²°
```javascript
const ws = new WebSocket('ws://localhost:3001/ws');
ws.onopen = () => {
  ws.send(JSON.stringify({ type: 'subscribe', all: true }));
};
ws.onmessage = (event) => console.log(JSON.parse(event.data));
```

---

## ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

### í…Œì´ë¸”

1. **token_scores** - ê°œë³„ í† í° ë°”ì´ëŸ´ ì ìˆ˜ (âœ… **ìƒˆë¡œ ì¶”ê°€: DB ì €ì¥**)
2. **pair_scores** - í’€ì„ ìœ„í•œ ì„œëª…ëœ í˜ì–´ ì ìˆ˜ (âœ… **ê°œì„ : ìë™ ì €ì¥**)
3. **pair_pools** - ë“±ë¡ëœ ê±°ë˜ í˜ì–´
4. **merkle_checkpoints** - ë§¤ì‹œê°„ Merkle íŠ¸ë¦¬ ìŠ¤ëƒ…ìƒ·
5. **memex_posts** - ìºì‹œëœ ì†Œì…œ ë¯¸ë””ì–´ ê²Œì‹œë¬¼

### ì£¼ìš” ê°œì„ ì‚¬í•­

#### âœ… í† í° ì ìˆ˜ DB ì €ì¥
ì´ì „ì—ëŠ” ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥ë˜ë˜ í† í° ì ìˆ˜ê°€ ì´ì œ **ë°ì´í„°ë² ì´ìŠ¤ì— ìë™ ì €ì¥**ë©ë‹ˆë‹¤:
- 10ì´ˆë§ˆë‹¤ ìë™ ì €ì¥
- íˆìŠ¤í† ë¦¬ ì¶”ì  ê°€ëŠ¥
- `/api/score/tokens/:symbol/history` ì—”ë“œí¬ì¸íŠ¸ë¡œ ì¡°íšŒ

#### âœ… í˜ì–´ ì ìˆ˜ ìë™ ì €ì¥
Merkle ì²´í¬í¬ì¸íŠ¸ ìƒì„± ì‹œ **ëª¨ë“  í˜ì–´ ì ìˆ˜ê°€ ìë™ìœ¼ë¡œ DBì— ì €ì¥**ë©ë‹ˆë‹¤:
- ë§¤ì‹œê°„ ìë™ ì €ì¥
- ECDSA ì„œëª… í¬í•¨
- ì˜¨ì²´ì¸ ê²€ì¦ ê°€ëŠ¥

### Drizzle ëª…ë ¹ì–´

```bash
# ìŠ¤í‚¤ë§ˆì—ì„œ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±
bun run db:generate

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰
bun run db:migrate

# Drizzle Studio ì—´ê¸° (GUI)
bun run db:studio
```

---

## â° ìŠ¤ì¼€ì¤„ëŸ¬ ì‘ì—…

### 1. ì ìˆ˜ ìˆ˜ì§‘ (10ì´ˆë§ˆë‹¤)
```
â”Œâ”€ ìµœì‹  Memex ê²Œì‹œë¬¼ ê°€ì ¸ì˜¤ê¸°
â”œâ”€ í† í° ë©˜ì…˜ ì¶”ì¶œ
â”œâ”€ ì°¸ì—¬ ì§€í‘œ ì§‘ê³„
â”œâ”€ ë°”ì´ëŸ´ ì ìˆ˜ ê³„ì‚°
â”œâ”€ âœ… ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ (ìƒˆë¡œ ì¶”ê°€!)
â””â”€ ì¸ë©”ëª¨ë¦¬ ìºì‹œ ì—…ë°ì´íŠ¸
```

**ì¶œë ¥:**
```
[Scheduler] TRUMP: score=8542, tier=LEGENDARY
[Scheduler] Score collection complete. 42 tokens updated and saved to DB
```

### 2. Merkle ì²´í¬í¬ì¸íŠ¸ (ë§¤ì‹œê°„)
```
â”Œâ”€ ëª¨ë“  í† í° í˜ì–´ ìƒì„±
â”œâ”€ í˜ì–´ ì ìˆ˜ ê³„ì‚°
â”œâ”€ âœ… ê° í˜ì–´ ì ìˆ˜ ì„œëª… (ECDSA) ë° DB ì €ì¥ (ê°œì„ !)
â”œâ”€ Merkle íŠ¸ë¦¬ êµ¬ì¶•
â”œâ”€ ì²´í¬í¬ì¸íŠ¸ ì €ì¥
â””â”€ WebSocket í´ë¼ì´ì–¸íŠ¸ì— ë¸Œë¡œë“œìºìŠ¤íŠ¸
```

**ì¶œë ¥:**
```
[Scheduler] Saving 156 pair scores to database...
[Scheduler] Merkle checkpoint complete. Epoch=42, pairs=156, saved=156
```

### 3. ìºì‹œ ì •ë¦¬ (5ë¶„ë§ˆë‹¤)
```
â”Œâ”€ ì²˜ë¦¬ëœ ê²Œì‹œë¬¼ ìºì‹œ ì •ë¦¬
â””â”€ ë©”ëª¨ë¦¬ì— ìƒìœ„ 100ê°œ í† í°ë§Œ ìœ ì§€
```

---

## ğŸ—ºï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    VIRAL SCORE COLLECTOR                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Memex API  â”‚  â”‚  PostgreSQL  â”‚  â”‚   WebSocket  â”‚         â”‚
â”‚  â”‚   Collector  â”‚  â”‚   Database   â”‚  â”‚    Server    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚
â”‚         â–¼                  â–¼                  â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚             ìŠ¤ì¼€ì¤„ëŸ¬ (3ê°œ ì‘ì—…)                   â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚ 1. ì ìˆ˜ ìˆ˜ì§‘ (10ì´ˆ)                               â”‚           â”‚
â”‚  â”‚    â€¢ Memex ê²Œì‹œë¬¼ ê°€ì ¸ì˜¤ê¸°                        â”‚           â”‚
â”‚  â”‚    â€¢ í† í° ì ìˆ˜ ê³„ì‚°                               â”‚           â”‚
â”‚  â”‚    â€¢ âœ… DB + ë©”ëª¨ë¦¬ì— ì €ì¥                        â”‚           â”‚
â”‚  â”‚                                                   â”‚           â”‚
â”‚  â”‚ 2. Merkle ì²´í¬í¬ì¸íŠ¸ (1ì‹œê°„)                      â”‚           â”‚
â”‚  â”‚    â€¢ ëª¨ë“  í˜ì–´ ì¡°í•© ìƒì„±                          â”‚           â”‚
â”‚  â”‚    â€¢ âœ… ëª¨ë“  í˜ì–´ ì ìˆ˜ ì„œëª… ë° DB ì €ì¥            â”‚           â”‚
â”‚  â”‚    â€¢ Merkle íŠ¸ë¦¬ êµ¬ì¶•                            â”‚           â”‚
â”‚  â”‚    â€¢ ì²´í¬í¬ì¸íŠ¸ ì €ì¥ + ë¸Œë¡œë“œìºìŠ¤íŠ¸               â”‚           â”‚
â”‚  â”‚                                                   â”‚           â”‚
â”‚  â”‚ 3. ìºì‹œ ì •ë¦¬ (5ë¶„)                                â”‚           â”‚
â”‚  â”‚    â€¢ ì²˜ë¦¬ëœ ê²Œì‹œë¬¼ ì •ë¦¬                           â”‚           â”‚
â”‚  â”‚    â€¢ ìƒìœ„ 100ê°œ í† í° ìœ ì§€                         â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚         â”‚                  â”‚                  â”‚                  â”‚
â”‚         â–¼                  â–¼                  â–¼                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ Score Calc   â”‚  â”‚   Signer     â”‚  â”‚   Merkle     â”‚         â”‚
â”‚  â”‚  Algorithm   â”‚  â”‚   (ECDSA)    â”‚  â”‚   Builder    â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                     REST API (Hono)                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ /api/score/*   - í† í° & í˜ì–´ ì ìˆ˜                       â”‚   â”‚
â”‚  â”‚ /api/merkle/*  - Merkle ì¦ëª… & ì²´í¬í¬ì¸íŠ¸               â”‚   â”‚
â”‚  â”‚ /health        - ì‹œìŠ¤í…œ í—¬ìŠ¤ ìƒíƒœ                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š API ì—”ë“œí¬ì¸íŠ¸

### í† í° ì ìˆ˜ API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/api/score/signer` | ì„œëª…ì ì£¼ì†Œ ì¡°íšŒ |
| GET | `/api/score/tokens` | ëª¨ë“  í† í° ì ìˆ˜ (ì‹¤ì‹œê°„, ë©”ëª¨ë¦¬) |
| GET | `/api/score/tokens/leaderboard` | ìƒìœ„ í† í° ë¦¬ë”ë³´ë“œ |
| GET | `/api/score/tokens/:symbol` | âœ… íŠ¹ì • í† í° ìµœì‹  ì ìˆ˜ (DB) |
| GET | `/api/score/tokens/:symbol/history` | âœ… í† í° ì ìˆ˜ íˆìŠ¤í† ë¦¬ (DB) |

### í˜ì–´ ì ìˆ˜ API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/api/score/pair/:tokenX/:tokenY` | í˜ì–´ ì ìˆ˜ ì¡°íšŒ (ë¯¸ì„œëª…) |
| POST | `/api/score/pair/:tokenX/:tokenY/sign` | í˜ì–´ ì ìˆ˜ ì„œëª… ë° ì €ì¥ |
| GET | `/api/score/pair/:tokenX/:tokenY/history` | í˜ì–´ ì ìˆ˜ íˆìŠ¤í† ë¦¬ |
| GET | `/api/score/pair/id/:poolId` | Pool IDë¡œ ìµœì‹  ì ìˆ˜ ì¡°íšŒ |
| POST | `/api/score/pair/register` | ìƒˆ í˜ì–´ í’€ ë“±ë¡ |
| GET | `/api/score/pairs` | ëª¨ë“  ë“±ë¡ëœ í˜ì–´ ì¡°íšŒ |

### Merkle API

| Method | Endpoint | ì„¤ëª… |
|--------|----------|------|
| GET | `/api/merkle/root` | í˜„ì¬ Merkle root |
| GET | `/api/merkle/proof/:poolId` | Pool IDì˜ Merkle ì¦ëª… |
| POST | `/api/merkle/verify` | Merkle ì¦ëª… ê²€ì¦ |
| GET | `/api/merkle/checkpoints` | ëª¨ë“  ì²´í¬í¬ì¸íŠ¸ ëª©ë¡ |
| GET | `/api/merkle/checkpoint/:epoch` | íŠ¹ì • epoch ì²´í¬í¬ì¸íŠ¸ |

---

## ğŸ“Š ì ìˆ˜ ê³„ì‚° ë¡œì§

```
rawScore = posts Ã— 100 + views Ã— 1 + likes Ã— 20 + reposts Ã— 50 + replies Ã— 30 + uniqueUsers Ã— 200

timeDecay = e^(-ageHours Ã— ln(2) / 24)  // 24ì‹œê°„ ë°˜ê°ê¸°

antiGaming = ì¡°ì‘ ë°©ì§€ ì²´í¬ (ìµœëŒ€ 50% í˜ë„í‹°)

enhancedMultipliers =
  â€¢ ê·¸ë˜ë“€ì—ì´ì…˜ í† í° ë³´ë„ˆìŠ¤: 1.5x
  â€¢ ì´ë¯¸ì§€ ê²Œì‹œë¬¼ ë³´ë„ˆìŠ¤: 1.2x
  â€¢ ê°€ê²© ë³€ë™ì„± ë³´ë„ˆìŠ¤: 1.1x

finalScore = normalize(rawScore Ã— timeDecay Ã— antiGaming Ã— enhancedMultipliers)  // 0-10000
```

### Score Tiers

| Score | Tier | ì„¤ëª… |
|-------|------|------|
| 8000-10000 | LEGENDARY | ê·¹ë„ë¡œ ë°”ì´ëŸ´í•œ ì½˜í…ì¸  |
| 6000-7999 | VIRAL | ë†’ì€ ì°¸ì—¬ë„ |
| 4000-5999 | HOT | ê°•í•œ ì°¸ì—¬ë„ |
| 2000-3999 | WARM | ì¤‘ê°„ ì°¸ì—¬ë„ |
| 500-1999 | ACTIVE | ë‚®ì€ ì°¸ì—¬ë„ |
| 0-499 | COLD | ìµœì†Œ ì°¸ì—¬ë„ |

---

## ğŸ”§ ë¬¸ì œ í•´ê²°

### ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨

**ì—ëŸ¬:** `Database connection failed`

**í•´ê²° ë°©ë²•:**
1. PostgreSQLì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸: `pg_isready`
2. `.env`ì˜ DATABASE_URL í™•ì¸
3. PostgreSQL ì—°ê²° í—ˆìš© í™•ì¸: `psql -U postgres`

### í† í° ì ìˆ˜ê°€ DBì— ì €ì¥ë˜ì§€ ì•ŠìŒ

**ì¦ìƒ:** ë©”ëª¨ë¦¬ì—ëŠ” ì ìˆ˜ê°€ ìˆì§€ë§Œ DBì— ì—†ìŒ

**í•´ê²° ë°©ë²•:**
1. ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í™•ì¸
2. `token_scores` í…Œì´ë¸” ì¡´ì¬ í™•ì¸
3. ë¡œê·¸ì—ì„œ ì €ì¥ ì˜¤ë¥˜ í™•ì¸
4. ë””ìŠ¤í¬ ê³µê°„ í™•ì¸

### Merkle ì²´í¬í¬ì¸íŠ¸ ì‹œ í˜ì–´ ì ìˆ˜ ì €ì¥ ì•ˆë¨

**í•´ê²° ì™„ë£Œ:** âœ… ì´ì œ Merkle ì²´í¬í¬ì¸íŠ¸ ìƒì„± ì‹œ ëª¨ë“  í˜ì–´ ì ìˆ˜ê°€ ìë™ìœ¼ë¡œ DBì— ì €ì¥ë©ë‹ˆë‹¤!

**í™•ì¸ ë°©ë²•:**
```sql
SELECT COUNT(*) FROM pair_scores WHERE created_at > NOW() - INTERVAL '1 hour';
```

### ìŠ¤ì¼€ì¤„ëŸ¬ ì‘ë™ ì•ˆí•¨

**ì—ëŸ¬:** ì ìˆ˜ê°€ ì—…ë°ì´íŠ¸ë˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•:**
1. í—¬ìŠ¤ ì²´í¬: `curl http://localhost:3001/health`
2. í—¬ìŠ¤ ì‘ë‹µì—ì„œ ìŠ¤ì¼€ì¤„ëŸ¬ ìƒíƒœ í™•ì¸
3. ë¡œê·¸ì—ì„œ ì—ëŸ¬ í™•ì¸
4. ì„œë²„ ì¬ì‹œì‘: `bun run start`

---

## ğŸ› ï¸ ê°œë°œ

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```
viral-score-collector/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ db/                     # ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •
â”‚   â”‚   â”œâ”€â”€ client.ts
â”‚   â”‚   â”œâ”€â”€ schema.ts
â”‚   â”‚   â””â”€â”€ migrate.ts
â”‚   â”œâ”€â”€ jobs/
â”‚   â”‚   â””â”€â”€ scheduler.ts        # í¬ë¡  ì‘ì—…
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ score.ts            # ì ìˆ˜ API
â”‚   â”‚   â””â”€â”€ merkle.ts           # Merkle API
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ memex-collector.ts  # ë°ì´í„° ìˆ˜ì§‘
â”‚   â”‚   â”œâ”€â”€ score-calculator.ts # ì ìˆ˜ ì•Œê³ ë¦¬ì¦˜
â”‚   â”‚   â”œâ”€â”€ signer.ts           # ECDSA ì„œëª…
â”‚   â”‚   â””â”€â”€ merkle-builder.ts   # Merkle íŠ¸ë¦¬
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ score.ts            # TypeScript íƒ€ì…
â”‚   â”œâ”€â”€ ws/
â”‚   â”‚   â””â”€â”€ stream.ts           # WebSocket í•¸ë“¤ëŸ¬
â”‚   â””â”€â”€ index.ts                # ì„œë²„ ì§„ì…ì 
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup-db.sh             # DB ì„¤ì • ìŠ¤í¬ë¦½íŠ¸
â”œâ”€â”€ .env                        # í™˜ê²½ ì„¤ì •
â”œâ”€â”€ API.md                      # API ë¬¸ì„œ (ì˜ë¬¸)
â””â”€â”€ README.md                   # ì´ íŒŒì¼
```

### ëª…ë ¹ì–´

```bash
# ê°œë°œ ëª¨ë“œ (watch)
bun run dev

# í”„ë¡œë•ì…˜ ì‹¤í–‰
bun run start

# DB ìŠ¤í‚¤ë§ˆ ìƒì„±
bun run db:generate

# DB ë§ˆì´ê·¸ë ˆì´ì…˜
bun run db:migrate

# Drizzle Studio (DB ê´€ë¦¬ GUI)
bun run db:studio
```

---

## ğŸš¢ ë°°í¬

### Docker Compose (ê¶Œì¥)

`docker-compose.yml` ìƒì„±:
```yaml
version: '3.8'

services:
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: viral_score_db
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  app:
    build: .
    ports:
      - "3001:3001"
    environment:
      DATABASE_URL: postgresql://postgres:postgres@postgres:5432/viral_score_db
      SIGNER_PRIVATE_KEY: ${SIGNER_PRIVATE_KEY}
    depends_on:
      - postgres

volumes:
  postgres_data:
```

ì‹¤í–‰:
```bash
docker-compose up -d
```

---

## ğŸ“„ ë¼ì´ì„ ìŠ¤

MIT License

---

## ğŸ™ ê°ì‚¬ì˜ ê¸€

- **Memex** - ì†Œì…œ ë¯¸ë””ì–´ ì°¸ì—¬ ë°ì´í„°
- **Drizzle ORM** - ë°ì´í„°ë² ì´ìŠ¤ íˆ´í‚·
- **Hono** - ë¹ ë¥¸ ì›¹ í”„ë ˆì„ì›Œí¬
- **Bun** - JavaScript ëŸ°íƒ€ì„
- **OpenZeppelin** - Merkle íŠ¸ë¦¬ êµ¬í˜„
- **viem** - Ethereum ìœ í‹¸ë¦¬í‹°

---

Made with â¤ï¸ by the Meme Pulse team
